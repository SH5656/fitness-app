<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Fitness Habit App</title>
<meta name="theme-color" content="#2ecc71">

<style>
*{box-sizing:border-box}

/* ===== THEMES ===== */
:root{
  --bg:#e8f5e9; --card:#fff; --accent:#2ecc71;
}
body.theme-1{--bg:#e8f5e9;--card:#fff;--accent:#2ecc71;}
body.theme-2{--bg:#e3f2fd;--card:#fff;--accent:#2196f3;}
body.theme-3{--bg:#fff3e0;--card:#fff;--accent:#ff9800;}
body.theme-4{--bg:#fce4ec;--card:#fff;--accent:#e91e63;}
body.theme-5{--bg:#ede7f6;--card:#fff;--accent:#673ab7;}
body.theme-6{--bg:#f3e5f5;--card:#fff;--accent:#9c27b0;}
body.theme-7{--bg:#e0f2f1;--card:#fff;--accent:#009688;}
body.theme-8{--bg:#fbe9e7;--card:#fff;--accent:#ff5722;}
body.theme-9{--bg:#eceff1;--card:#fff;--accent:#607d8b;}
body.theme-10{--bg:#fffde7;--card:#fff;--accent:#fbc02d;}

body{
  margin:0;
  font-family:Segoe UI,Arial;
  background:var(--bg);
  padding:12px;
}

.app{
  max-width:480px;
  margin:auto;
  background:var(--card);
  padding:14px;
  border-radius:18px;
  box-shadow:0 10px 25px rgba(0,0,0,.2);
}

h2,h3{text-align:center;margin:6px 0}

button{
  width:100%;
  padding:10px;
  margin:6px 0;
  border:none;
  border-radius:10px;
  background:var(--accent);
  color:#fff;
  font-size:15px;
}

.card{
  background:#f9f9f9;
  padding:10px;
  border-radius:12px;
  margin:10px 0;
}

.table-wrap{overflow-x:auto}
table{
  min-width:720px;
  width:100%;
  border-collapse:collapse;
  font-size:13px;
}
th,td{padding:6px;text-align:center}
th{background:#f1f1f1}
tr.today{background:#fff6c1}
input[type=checkbox]{transform:scale(1.2)}
input[type=checkbox]:disabled{opacity:.3}
.progress{font-weight:bold;color:var(--accent)}

.timer{font-size:22px;text-align:center}
</style>
</head>

<body class="theme-1">

<div class="app">

<h2 id="monthYear"></h2>
<h3 id="weekTitle"></h3>
<div id="streak">üî• Streak: 0 days</div>

<button onclick="changeTheme()">üé® Change Theme</button>

<div class="card">
<div style="display:flex;gap:6px">
<button onclick="changeWeek(-1)">‚¨Ö Prev</button>
<button onclick="changeWeek(1)">Next ‚û°</button>
</div>
</div>

<div class="table-wrap card">
<table>
<thead>
<tr>
<th>Date</th><th>Day</th>
<th>Goal</th><th>Sleep</th><th>Wake</th>
<th>Food</th><th>Study</th><th>Run</th>
<th>Exercise</th><th>Book</th><th>%</th>
</tr>
</thead>
<tbody id="chartBody"></tbody>
</table>
</div>

<div class="card">
<h3>‚è± Workout Timer</h3>
<div class="timer" id="timer">00:00</div>
<button onclick="startTimer()">Start</button>
<button onclick="stopTimer()">Stop</button>
</div>

<div class="card">
<h3>üíß Water (glasses)</h3>
<input type="number" id="water">
<button onclick="saveWater()">Save</button>
</div>

<div class="card">
<h3>‚öñÔ∏è Weight (kg)</h3>
<input type="number" step="0.1" id="weight">
<button onclick="saveWeight()">Save</button>
</div>

<div class="card">
<h3>üîî Daily Reminder</h3>
<input type="time" id="reminderTime">
<button onclick="setReminder()">Set Reminder</button>
</div>

</div>

<!-- Sound -->
<audio id="tickSound" preload="auto">
<source src="https://assets.mixkit.co/sfx/preview/mixkit-click-1124.mp3">
</audio>

<script>
/* ===== BASIC ===== */
const habits=8;
const days=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];
const today=new Date(); today.setHours(0,0,0,0);
let weekOffset=0;
const tickSound=document.getElementById("tickSound");

/* ===== THEME ===== */
let theme=localStorage.getItem("theme")||1;
document.body.className="theme-"+theme;
function changeTheme(){
  theme++; if(theme>10) theme=1;
  document.body.className="theme-"+theme;
  localStorage.setItem("theme",theme);
}

/* ===== HEADER ===== */
document.getElementById("monthYear").innerText =
today.toLocaleString("default",{month:"long",year:"numeric"});

/* ===== WEEK ===== */
function weekStart(d){
  let x=new Date(d); x.setDate(x.getDate()-x.getDay()); return x;
}
function changeWeek(v){weekOffset+=v;render();}

/* ===== RENDER ===== */
function render(){
  const start=weekStart(new Date(today.getTime()+weekOffset*7*86400000));
  document.getElementById("weekTitle").innerText="Week of "+start.toDateString();
  const body=document.getElementById("chartBody"); body.innerHTML="";
  for(let i=0;i<7;i++){
    let d=new Date(start); d.setDate(start.getDate()+i);
    if(d.getMonth()!=today.getMonth()) continue;
    let isToday=d.toDateString()===today.toDateString();
    let row=document.createElement("tr");
    if(isToday) row.classList.add("today");
    let html=`<td>${d.getDate()}</td><td>${days[d.getDay()]}</td>`;
    for(let h=0;h<habits;h++){
      let key=`${today.getFullYear()}-${today.getMonth()}_${d.getDate()}_${h}`;
      let checked=localStorage.getItem(key)==="true";
      html+=`<td><input type="checkbox"
      ${checked?"checked":""}
      ${!isToday?"disabled":""}
      onclick="saveTick('${key}',this)"></td>`;
    }
    html+=`<td class="progress">0%</td>`;
    row.innerHTML=html; body.appendChild(row);
  }
  calc();
}

/* ===== TICK (SOUND FIXED) ===== */
function saveTick(key,el){
  localStorage.setItem(key,el.checked);
  tickSound.currentTime=0;
  tickSound.play();
  localStorage.setItem("done_"+today.toDateString(),"yes");
  updateStreak(); calc();
}

/* ===== PROGRESS ===== */
function calc(){
  document.querySelectorAll("tbody tr").forEach(r=>{
    let c=0; r.querySelectorAll("input").forEach(b=>{if(b.checked)c++});
    r.querySelector(".progress").innerText=Math.round((c/habits)*100)+"%";
  });
}

/* ===== STREAK ===== */
function updateStreak(){
  let y=new Date(Date.now()-86400000).toDateString();
  let t=today.toDateString();
  let s=parseInt(localStorage.getItem("streak")||0);
  if(localStorage.getItem("done_"+t)!=="yes") return;
  if(localStorage.getItem("done_"+y)==="yes") s++; else s=1;
  localStorage.setItem("streak",s);
  document.getElementById("streak").innerText="üî• Streak: "+s+" days";
}
document.getElementById("streak").innerText=
"üî• Streak: "+(localStorage.getItem("streak")||0)+" days";

/* ===== TIMER ===== */
let sec=0,interval;
function startTimer(){
  clearInterval(interval);
  interval=setInterval(()=>{
    sec++;
    let m=Math.floor(sec/60),s=sec%60;
    timer.innerText=String(m).padStart(2,"0")+":"+String(s).padStart(2,"0");
  },1000);
}
function stopTimer(){clearInterval(interval)}

/* ===== WATER / WEIGHT ===== */
function saveWater(){
  localStorage.setItem("water_"+today.toDateString(),
  document.getElementById("water").value);
}
function saveWeight(){
  localStorage.setItem("weight_"+today.toDateString(),
  document.getElementById("weight").value);
}

/* ===== REMINDER (WORKING METHOD) ===== */
function setReminder(){
  let t=document.getElementById("reminderTime").value;
  if(!t) return alert("Select time");
  localStorage.setItem("reminderTime",t);
  Notification.requestPermission().then(()=>{
    alert("Reminder saved.\nApp must be added to Home Screen.");
  });
}

setInterval(()=>{
  let t=localStorage.getItem("reminderTime");
  if(!t) return;
  let n=new Date();
  let cur=n.getHours()+":"+String(n.getMinutes()).padStart(2,"0");
  if(cur===t){
    new Notification("üèãÔ∏è Fitness Reminder",{
      body:"Time to complete today‚Äôs habits üí™"
    });
  }
},60000);

render();
</script>

</body>
</html>
